(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-commons"],{"47c4":function(e,t,i){"use strict";var n=i("c3b9"),a=i.n(n);a.a},"70a2":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:e.action,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"list-type":"picture",limit:e.limit,data:e.formdata,"before-upload":e.before,multiple:!0,"on-success":e.success,"on-change":e.change,"on-error":e.error,accept:e.type,"file-list":e.filelist}},[i("label",[e._v(e._s(e.label))]),e._v(" "),i("el-button",{attrs:{size:"medium",type:"info"},on:{click:e.upload}},[e._v("上传")]),e._v(" "),i("span",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.msg))]),e._v(" "),i("video",{ref:"noneVideo",staticStyle:{display:"none"},attrs:{src:""}})],1)},a=[],s=(i("7f7f"),i("6b54"),i("96cf"),i("3b8d")),o=(i("3123"),i("3e8f"),i("5c96")),r=i("91b6"),c=(i("d3f5"),i("3022"),{name:"SingleImageUpload3",props:["msg","label","size","type","limit","filelist","clear","time"],data:function(){return{formdata:{},file:[],action:"",config:"",removeFile:[],successFile:[],keybox:[],num:0,videoDuratime:!0}},watch:{file:function(e,t){this.$emit("files",e)},clear:function(e,t){console.log("清理了"),this.$refs.upload.clearFiles()}},mounted:function(){void 0!=this.filelist&&(this.file=this.filelist)},methods:{upload:function(){var e=this;return new Promise((function(t,i){Object(r["a"])().then((function(t){var i=t.data,n=JSON.parse(window.atob(i.config));e.config=n,e.action=n.domain,e.formdata={OSSAccessKeyId:n.access_key_id,policy:n.policy,Signature:n.signature,success_action_status:"200"}})).catch((function(e){i(e)}))}))},handleRemove:function(e,t){for(var i=0;i<this.file.length;i++)this.file[i].uid==e.uid&&(this.file.splice(i,1),this.keybox.splice(i,1))},handlePreview:function(e){console.log(e)},before:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var i,n,a,s,r,c,u,l,f,d,p,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.size>this.size)){e.next=3;break}return Object(o["Message"])({message:"请选择正确尺寸的文件",type:"error",duration:5e3}),e.abrupt("return",!1);case 3:if(i=t.type.substring(t.type.indexOf("/")+1,t.type.length),"jpeg"==i&&(i="jpg"),!(this.type.indexOf(i)<0)){e.next=8;break}return Object(o["Message"])({message:"请选择正确格式的文件",type:"error",duration:5e3}),e.abrupt("return",!1);case 8:if("mp4"!=i){e.next=19;break}return n=URL.createObjectURL(t),a=new Audio(n),s=this.time,r=new Promise((function(e,t){a.addEventListener("loadedmetadata",(function(t){e(a.duration)}))})),e.next=15,r;case 15:if(c=e.sent,!(c>s)){e.next=19;break}return Object(o["Message"])({message:"视频时长不能大于".concat(s/60," 分钟"),type:"error",duration:5e3}),e.abrupt("return",!1);case 19:u=(new Date).getTime(),l=Math.random().toString(36).substr(-10),f=t.name.lastIndexOf("."),d=t.name.length,p=t.name.substring(f+1,d),h=t.name.indexOf("jpg")>-1||t.name.indexOf("png")>-1||t.name.indexOf("gif")?"images":t.name.indexOf("mp4")>-1?"video":"audio",this.$set(this.formdata,"key","pulic/".concat(h,"/").concat(u).concat(l,".").concat(p)),this.keybox.push({url:"".concat(this.action,"/").concat(this.formdata.key),uid:t.uid});case 27:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),success:function(e,t,i){for(var n=0;n<this.keybox.length;n++)this.file.push({url:this.keybox[n].url,name:t.name,uid:this.keybox[n].uid});for(var a=0;a<this.file.length;a++)for(var s=a+1;s<this.file.length;s++)this.file[a].uid==this.file[s].uid&&this.file.splice(s,1);Object(o["Message"])({message:"上传成功",type:"success",duration:5e3})},change:function(e){},error:function(e){Object(o["Message"])({message:"上传失败，请重试",type:"error",duration:5e3})}},ha:function(e,t){this.action=e}}),u=c,l=(i("47c4"),i("2877")),f=Object(l["a"])(u,n,a,!1,null,"83f49acc",null);t["a"]=f.exports},c3b9:function(e,t,i){}}]);